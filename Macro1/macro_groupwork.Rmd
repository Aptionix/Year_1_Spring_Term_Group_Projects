---
title: "Macroeconomics 1 Group Presentation"
output: pdf_document
author: 'Group C4'
---
```{r Libraries, message = F}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(ggplot2)
library(readr)
library(readxl)
library(ggpubr)
```

```{r load datasets, message = F}
# Load Penn World Table
pwt <- read_excel("pwt110.xlsx", sheet = "Data") %>%
  mutate(across(where(is.numeric), ~ signif(.x, 4)))


# Load World Economic Outlook database for some additional info
# (not the entire database, only part of it)
weo <- read_csv("WEO_IMF.csv")
```

```{r clean data}
pwt <- pwt %>%
  filter(year >= 1970) %>%
  filter(countrycode %in% c("GBR", "IRL", "USA")) %>%
  select(year, countrycode, pop, emp, avh, hc, rnna, rtfpna, delta, rgdpna) %>%
  na.omit() %>%
  mutate(rgdpna_pc = rgdpna / pop) %>%
  mutate(rnna_pc = rnna / pop)

pwt_pop_emp <- pwt %>%
  select(year, countrycode, pop, emp, avh, hc) %>%
  pivot_longer(cols = -c(year, countrycode), values_to = "Value", names_to = "Indicator")

pwt_capital <- pwt %>%
  select(year, countrycode, rnna, rnna_pc, rgdpna_pc, rgdpna, rtfpna, delta) %>%
  pivot_longer(cols = -c(year, countrycode), values_to = "Value", names_to = "Indicator")
```


# Question 2
```{r question 2}
# ---- Population & Employment -----
pwt_pop_emp %>%
  filter(countrycode == "IRL", Indicator %in% c("emp", "pop")) %>%
  ggplot(aes(x = year, y = Value, colour = Indicator)) +
  geom_line() +
  geom_point(alpha = 0.2, size = 1) +
  theme_minimal() +
  scale_color_manual(values = c("#0072B2", "#E69F00")) +
  labs(
    y = "Population (millions)", x = "Year"
  )


line_plot_1 <- function(data, indicator, ylab) {
  data %>%
    filter(Indicator == indicator) %>%
    ggplot(aes(x = year, y = Value, colour = countrycode)) +
    geom_line() +
    geom_point(alpha = 0.2, size = 1) +
    scale_color_manual(values = c("#1F77FF", "#FF7F0E", "#2CA02C")) +
    theme_minimal() +
    labs(x = "Year", y = ylab)
}

avh <- line_plot_1(pwt_pop_emp, "avh", "average annual working hours")

hc <- line_plot_1(pwt_pop_emp, "hc", "Human Capital Index")

ggarrange(avh, hc,
  font.label = list(size = 12), vjust = 18, ncol = 1, nrow = 2,
  common.legend = TRUE, legend = "right"
)


# ----TFP & Capital----

tfp <- line_plot_1(pwt_capital, "rtfpna", "TFP (2021 = 1)")

capital_stock <- line_plot_1(pwt_capital, "rnna_pc", "k (2021 US$)")

depreciation <- line_plot_1(pwt_capital, "delta", "Depreciation Rate")

rgdp_pc <- line_plot_1(pwt_capital, "rgdpna_pc", "rGDP/capita (2021 US$)")

ggarrange(tfp, depreciation,
  ncol = 1, nrow = 2,
  common.legend = TRUE, legend = "right"
)

ggarrange(capital_stock, rgdp_pc,
  ncol = 1, nrow = 2,
  common.legend = TRUE, legend = "right"
)
```

From the previous 4 graphs, we can primarily see the following happened in Ireland:

1. There is a constant increasing rate in population and HCI growth rate;
2. There is a higher 


Then we want to see how accurate was the Solow model in estimating the GDP in Ireland.

We note that in Solow Model
$$
y_t = \bar{A} k^\alpha
$$
so we would like to name a new variable y* to estimate the predicted per capita 
output level by the Solow model.


```{r Solow Model}
pwt <- pwt %>%
  mutate(
    rgdpna_pc_adjust_A = rgdpna_pc / rtfpna,
    y_0.44 = (rnna_pc * 10^6)^(0.44),
    y_0.43 = (rnna_pc * 10^6)^(0.43)
  ) %>%
  mutate(across(where(is.numeric), ~ signif(.x, 4)))


pwt_solow <- pwt %>%
  select(year, countrycode, y_0.43, y_0.44, rgdpna_pc_adjust_A) %>%
  filter(countrycode == "IRL") %>%
  pivot_longer(cols = -c(year, countrycode), values_to = "value", names_to = "indicator")

pwt_solow %>% ggplot(aes(x = year, y = value, colour = indicator)) +
  geom_line() +
  geom_point(alpha = 0.2, size = 1) +
  theme_minimal()
```

The above graph shows that the Solow model with $\alpha = 0.43$ is a good estimation
of the actual per capita GDP during 1970 to around 2000, and Solow model with 
$\alpha = 0.44$ is a good estimation of the actual per capita GDP during 2000 to 
2008, which suggest that the capital share in Ireland was around 43% in the earlier period and
increased to around 44% in the later period. However, after 2010, both models fail to capture the
actual per capita GDP, which could be due to various factors such as changes in technology, labor
market dynamics, or other macroeconomic shocks that are not accounted for in the Solow model.

For example, in 2008, the 
